//NICE POPUP v0.0.1
"use strict";!function(){function e(e,n){h?(e.startEvent=function(n){n.stopPropagation(),e.time=+new Date,e.startX=n.changedTouches[0].pageX,e.startY=n.changedTouches[0].pageY},e.endEvent=function(t){t.stopPropagation(),t.preventDefault(),+new Date-e.time<200&&Math.abs(t.changedTouches[0].pageX-e.startX)<5&&Math.abs(t.changedTouches[0].pageY-e.startY)<5&&n(t)},e.addEventListener(E.start,e.startEvent),e.addEventListener(E.end,e.endEvent)):(e.clickEvent=n,e.addEventListener(E.click,e.clickEvent))}function n(e){h?(e.removeEventListener(E.start,e.startEvent),e.removeEventListener(E.end,e.endEvent)):e.removeEventListener(E.click,e.clickEvent)}function t(e,n){c(e,n)||(e.className+=" "+n)}function o(e,n){var t=n.split(" "),o=null;t.map(function(n){o=new RegExp("(s*|^)"+n+"(s*|$)","g"),e.className=e.className.replace(o," ")})}function c(e,n){return e.className.indexOf(n)>-1}function r(){var e="",n=arguments[0],t=Array.prototype.slice.call(arguments,1);return t.map(function(t,o){for(e in t)n[e]=t[e]}),n}function i(e,n){n&&Array.prototype.map.call(e,function(e){n(e)})}function s(n){var t=document.createElement("div"),c=this;t.className="nice-popup popup-ready",t.innerHTML='<a href="javascript:" class="popup-close">close</a>',e(t.querySelector(".popup-close"),function(){c.close()}),t.appendChild(n),o(n,"nice-popup"),document.body.appendChild(t),this.wrapper=t,this.dom=n,v.push(this)}function a(e){for(var n=0,t=v.length,o=null,c={};t>n;n++)if(o=v[n],o&&o.dom===e){c=o;break}return c}function l(){var e=document.querySelectorAll(".nice-popup");i(e,function(e){new s(e)})}function p(e){r(g,e)}function u(e){if(e){var t=e.dom.querySelector(".ok"),o=e.dom.querySelector(".cancel"),c=e.wrapper.querySelector(".popup-close");t&&n(t),o&&n(o),c&&n(c),document.body.removeChild(e.wrapper);var r="";for(r in e)delete e[r]}}function f(){m[0]&&m[0].close()}function d(){m=m.slice(0,1),m[0]&&m[0].close()}var m=[],v=[],h="ontouchend"in document,y=window.PointerEvent||window.MSPointerEvent,w=function(e){return window.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e},E={click:"click",start:h?y?w("pointerdown"):"touchstart":"mousedown",move:h?y?w("pointermove"):"touchmove":"mousemove",end:h?y?w("pointerup"):"touchend":"mouseup",cancel:h?y?w("pointercancel"):"touchcancel":"mousecancel"},k=function(){function n(){i||(i=!0,t(r,"nice-mask"),document.body.appendChild(r),k.close=c,e(r,function(){m[0]&&m[0].close()})),t(r,"show"),o(r,"reverse")}function c(){i&&t(r,"reverse")}var r=document.createElement("div"),i=!1;return{open:n}}(),g={autoClose:!1,effect:"popin",modal:!0,closeable:!0};s.prototype={open:function(e){var n=this.cfg||g,c=this;e&&(this.cfg=n=r({},n,e)),m[0]&&m[0].close(!0),m.unshift(this),n.modal&&k.open(),n.autoClose>0&&(this.closeTimer=setTimeout(function(){c.close()},n.autoClose)),this.wrapper.className="nice-popup popup-ready",n.effect?t(this.wrapper,n.effect):t(this.wrapper,"open"),o(this.wrapper,"reverse"),n.closeable===!1?this.wrapper.querySelector(".popup-close").style.display="none":this.wrapper.querySelector(".popup-close").style.display="block";var i=this.dom.querySelector(".ok");i&&i.focus()},close:function(e){var n=this.cfg||g;n.modal&&k.close&&k.close(),n.effect?t(this.wrapper,"reverse"):o(this.wrapper,"open");var c=this.dom.querySelector(".ok");c&&c.blur(),e||(m.shift(this),m.length>0&&m.shift().open())}};var S=function(){function n(n,o){function c(e){s.prototype.close.call(i,e),e||setTimeout(function(){u(i)},3e3)}var r=document.createElement("div"),i=null;r.innerHTML='<span class="type-icon"></span><span class="txt">'+n+'</span><div class="popup-btns"><a href="javascript:" class="ok">确定</a></div>',t(r,"alert-content"),i=new s(r),i.txtContent=i.dom.querySelector(".txt"),i.close=c,i.okFn=function(){i.close()},e(r.querySelector(".ok"),i.okFn),r.className="alert-content",t(r,o||""),n&&(i.txtContent.innerHTML=n),i.open()}return{open:n}}(),q=function(){function n(n,o){function c(e){s.prototype.close.call(r,e),e||setTimeout(function(){u(r)},3e3)}var r=null,i=null;i=document.createElement("div"),i.innerHTML='<div class="confirm-tip">'+n+'</div><div class="popup-btns"><a href="javascript:" class="ok">确定</a><a href="javascript:" class="cancel">取消</a></div>',t(i,"confirm-content"),r=new s(i),r.txtContent=r.dom.querySelector(".confirm-tip"),r.close=c,r.okFn=function(){o&&o(r)},r.cancelFn=function(){r.close()},e(i.querySelector(".ok"),r.okFn),e(i.querySelector(".cancel"),r.cancelFn),n&&(r.txtContent.innerHTML=n),r.open()}return{open:n}}(),b=function(){function e(e,n){var t="string"==typeof e?document.querySelector(e):"object"==typeof e?e:null,o=r({},g,n);t&&a(t).open(o)}return{open:e,close:f}}(),T={alert:S,confirm:q,dialog:b,init:l,close:f,closeAll:d,config:p};"function"==typeof define&&define.amd?define([],function(){return T}):"undefined"!=typeof module&&module.exports?module.exports=T:window.nicePopup=T}();