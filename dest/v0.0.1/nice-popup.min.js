//NICE POPUP v0.0.1
"use strict";!function(){function e(e,t){n(e,t)||(e.className+=" "+t)}function t(e,t){var n=t.split(" "),o=null;n.map(function(t){o=new RegExp("(s*|^)"+t+"(s*|$)","g"),e.className=e.className.replace(o," ")})}function n(e,t){return e.className.indexOf(t)>-1}function o(){var e="",t=arguments[0],n=Array.prototype.slice.call(arguments,1);return n.map(function(n,o){for(e in n)t[e]=n[e]}),t}function c(e,t){t&&Array.prototype.map.call(e,function(e){t(e)})}function r(e){var t=document.createElement("div"),n=this;t.className="nice-popup popup-ready",t.innerHTML='<a href="javascript:" class="popup-close">close</a>',this.closeFn=function(){n.close()},t.querySelector(".popup-close").addEventListener(h.start,this.closeFn),t.appendChild(e),document.body.appendChild(t),this.wrapper=t,this.dom=e,f.push(this)}function i(e){for(var t=0,n=f.length,o=null,c={};n>t;t++)if(o=f[t],o&&o.dom===e){c=o;break}return c}function s(){var e=document.querySelectorAll(".nice-popup");c(e,function(e){new r(e)})}function a(e){o(w,e)}function l(e){if(e){var t=e.dom.querySelector(".ok"),n=e.dom.querySelector(".cancel"),o=e.dom.querySelector(".popup-close");t&&t.removeEventListener(h.start,e.okFn),n&&n.removeEventListener(h.start,e.cancelFn),o&&o.removeEventListener(h.start,e.closeFn),document.body.removeChild(e.wrapper);var c="";for(c in e)delete e[c]}}function p(){u[0]&&u[0].close()}var u=[],f=[],d="ontouchend"in document,m=window.PointerEvent||window.MSPointerEvent,v=function(e){return window.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e},h={click:"click",start:d?m?v("pointerdown"):"touchstart":"click"},y=function(){function n(){r||(r=!0,e(c,"nice-mask"),document.body.appendChild(c),y.close=o,c.addEventListener(h.start,function(){u[0].close()})),setTimeout(function(){e(c,"show"),t(c,"reverse")},0)}function o(){r&&e(c,"reverse")}var c=document.createElement("div"),r=!1;return{open:n}}(),w={autoClose:!1,effect:"popin",modal:!0,closeable:!0};r.prototype={open:function(n){var c=this.cfg||w,r=this;n&&(this.cfg=c=o({},c,n)),u[0]&&u[0].close(!0),u.unshift(this),c.modal&&y.open(),c.autoClose>0&&(this.closeTimer=setTimeout(function(){r.close()},c.autoClose)),c.effect?e(this.wrapper,c.effect):(this.wrapper.className="nice-popup popup-ready",e(this.wrapper,"open")),t(this.wrapper,"reverse"),c.closeable===!1?this.wrapper.querySelector(".popup-close").style.display="none":this.wrapper.querySelector(".popup-close").style.display="block";var i=this.dom.querySelector(".ok");i&&i.focus()},close:function(n){var o=this.cfg||w;o.modal&&y.close(),o.effect?e(this.wrapper,"reverse"):t(this.wrapper,"open");var c=this.dom.querySelector(".ok");c&&c.blur(),n||(u.shift(this),u.length>0&&u.shift().open())}};var k=function(){function t(t,n){function o(e){r.prototype.close.call(i,e),e||setTimeout(function(){l(i)},3e3)}var c=document.createElement("div"),i=null;c.innerHTML='<span class="type-icon"></span><span class="txt">'+t+'</span><div class="popup-btns"><a href="javascript:" class="ok">确定</a></div>',e(c,"alert-content"),i=new r(c),i.txtContent=i.dom.querySelector(".txt"),i.close=o,i.okFn=function(){i.close()},c.querySelector(".ok").addEventListener(h.start,i.okFn),c.className="alert-content",e(c,n||""),t&&(i.txtContent.innerHTML=t),i.open()}return{open:t}}(),S=function(){function t(t,n){function o(e){r.prototype.close.call(c,e),e||setTimeout(function(){l(c)},3e3)}var c=null,i=null;i=document.createElement("div"),i.innerHTML='<div class="confirm-tip">'+t+'</div><div class="popup-btns"><a href="javascript:" class="ok">确定</a><a href="javascript:" class="cancel">取消</a></div>',e(i,"confirm-content"),c=new r(i),c.txtContent=c.dom.querySelector(".confirm-tip"),c.close=o,c.okFn=function(){n&&n(c)},c.cancelFn=function(){c.close()},i.querySelector(".ok").addEventListener(h.start,c.okFn),i.querySelector(".cancel").addEventListener(h.start,c.cancelFn),t&&(c.txtContent.innerHTML=t),c.open()}return{open:t}}(),E=function(){function e(e,t){var n="string"==typeof e?document.querySelector(e):"object"==typeof e?e:null,c=o({},w,t);n&&i(n).open(c)}return{open:e,close:p}}(),q={alert:k,confirm:S,dialog:E,init:s,close:p,config:a};"function"==typeof define&&define.amd?define([],function(){return q}):"undefined"!=typeof module&&module.exports?module.exports=q:window.nicePopup=q}();