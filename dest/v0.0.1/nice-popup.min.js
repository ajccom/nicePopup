//NICE POPUP v0.0.1
"use strict";!function(){function e(e,n){t(e,n)||(e.className+=" "+n)}function n(e,n){var t=n.split(" "),o=null;t.map(function(n){o=new RegExp("(s*|^)"+n+"(s*|$)","g"),e.className=e.className.replace(o," ")})}function t(e,n){return e.className.indexOf(n)>-1}function o(){var e="",n=arguments[0],t=Array.prototype.slice.call(arguments,1);return t.map(function(t,o){for(e in t)n[e]=t[e]}),n}function c(e,n){n&&Array.prototype.map.call(e,function(e){n(e)})}function r(e){var t=document.createElement("div"),o=this;t.className="nice-popup popup-ready",t.innerHTML='<a href="javascript:" class="popup-close">close</a>',this.closeFn=function(){o.close()},t.querySelector(".popup-close").addEventListener(y.start,this.closeFn),t.appendChild(e),n(e,"nice-popup"),document.body.appendChild(t),this.wrapper=t,this.dom=e,d.push(this)}function i(e){for(var n=0,t=d.length,o=null,c={};t>n;n++)if(o=d[n],o&&o.dom===e){c=o;break}return c}function s(){var e=document.querySelectorAll(".nice-popup");c(e,function(e){new r(e)})}function l(e){o(k,e)}function a(e){if(e){var n=e.dom.querySelector(".ok"),t=e.dom.querySelector(".cancel"),o=e.dom.querySelector(".popup-close");n&&n.removeEventListener(y.start,e.okFn),t&&t.removeEventListener(y.start,e.cancelFn),o&&o.removeEventListener(y.start,e.closeFn),document.body.removeChild(e.wrapper);var c="";for(c in e)delete e[c]}}function p(){f[0]&&f[0].close()}function u(){f=f.slice(0,1),f[0]&&f[0].close()}var f=[],d=[],m="ontouchend"in document,v=window.PointerEvent||window.MSPointerEvent,h=function(e){return window.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e},y={click:"click",start:m?v?h("pointerdown"):"touchstart":"click"},w=function(){function t(){r||(r=!0,e(c,"nice-mask"),document.body.appendChild(c),w.close=o,c.addEventListener(y.start,function(){f[0].close()})),setTimeout(function(){e(c,"show"),n(c,"reverse")},0)}function o(){r&&e(c,"reverse")}var c=document.createElement("div"),r=!1;return{open:t}}(),k={autoClose:!1,effect:"popin",modal:!0,closeable:!0};r.prototype={open:function(t){var c=this.cfg||k,r=this;t&&(this.cfg=c=o({},c,t)),f[0]&&f[0].close(!0),f.unshift(this),c.modal&&w.open(),c.autoClose>0&&(this.closeTimer=setTimeout(function(){r.close()},c.autoClose)),c.effect?e(this.wrapper,c.effect):(this.wrapper.className="nice-popup popup-ready",e(this.wrapper,"open")),n(this.wrapper,"reverse"),c.closeable===!1?this.wrapper.querySelector(".popup-close").style.display="none":this.wrapper.querySelector(".popup-close").style.display="block";var i=this.dom.querySelector(".ok");i&&i.focus()},close:function(t){var o=this.cfg||k;o.modal&&(console.log(1),w.close&&w.close()),o.effect?e(this.wrapper,"reverse"):n(this.wrapper,"open");var c=this.dom.querySelector(".ok");c&&c.blur(),t||(f.shift(this),f.length>0&&f.shift().open())}};var S=function(){function n(n,t){function o(e){r.prototype.close.call(i,e),e||setTimeout(function(){a(i)},3e3)}var c=document.createElement("div"),i=null;c.innerHTML='<span class="type-icon"></span><span class="txt">'+n+'</span><div class="popup-btns"><a href="javascript:" class="ok">确定</a></div>',e(c,"alert-content"),i=new r(c),i.txtContent=i.dom.querySelector(".txt"),i.close=o,i.okFn=function(){i.close()},c.querySelector(".ok").addEventListener(y.start,i.okFn),c.className="alert-content",e(c,t||""),n&&(i.txtContent.innerHTML=n),i.open()}return{open:n}}(),E=function(){function n(n,t){function o(e){r.prototype.close.call(c,e),e||setTimeout(function(){a(c)},3e3)}var c=null,i=null;i=document.createElement("div"),i.innerHTML='<div class="confirm-tip">'+n+'</div><div class="popup-btns"><a href="javascript:" class="ok">确定</a><a href="javascript:" class="cancel">取消</a></div>',e(i,"confirm-content"),c=new r(i),c.txtContent=c.dom.querySelector(".confirm-tip"),c.close=o,c.okFn=function(){t&&t(c)},c.cancelFn=function(){c.close()},i.querySelector(".ok").addEventListener(y.start,c.okFn),i.querySelector(".cancel").addEventListener(y.start,c.cancelFn),n&&(c.txtContent.innerHTML=n),c.open()}return{open:n}}(),q=function(){function e(e,n){var t="string"==typeof e?document.querySelector(e):"object"==typeof e?e:null,c=o({},k,n);t&&i(t).open(c)}return{open:e,close:p}}(),L={alert:S,confirm:E,dialog:q,init:s,close:p,closeAll:u,config:l};"function"==typeof define&&define.amd?define([],function(){return L}):"undefined"!=typeof module&&module.exports?module.exports=L:window.nicePopup=L}();